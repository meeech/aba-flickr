<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
    <head>
        <title></title>
        <script src="http://yui.yahooapis.com/3.0.0/build/yui/yui-min.js"></script>
    </head>
    <body>
<style type="text/css" media="screen">
div#shell {
    border: 1px solid red;
    height: 100%;
    width: 100%;
}

div#shell div {
    border: 1px solid grey;
    display: inline-block;
}
div#shell div span {
    border: 1px solid blue;
    display: block;
    text-align: center;
}
.hide {
    display: none !important;
}
</style>
<div id="shell">
</div>

<script type="text/javascript" charset="utf-8">
//Init so it has global scope
var jsonFlickrFeed;

YUI().use('node', 'substitute', 'dump', function(Y) {

jsonFlickrFeed = function (data) {
    if( Y.Lang.isUndefined(data.items)) { return false; }
    var items = data.items;

    var container = Y.Node.create('<div id="montreal"></div>');
    var randomIndex = Math.floor(Math.random()*items.length); //Can this be a bug? ever be == length?
    Y.each(items, function(item, index) {
        console.log(item);
        item['thumb_src'] = item.media.m; //fix the src
        item['image_src'] = item.media.m.replace('_m.jpg', '.jpg'); //fix the src
        item['class'] = (index != randomIndex) ? "hide" : "show" ;
        var nodehtml = Y.substitute(
            "<div class={class}><a href='{image_src}'><img src='{thumb_src}'></a><br><span>{title}</span></div>", item);
        container.append(Y.Node.create(nodehtml));
    });
    Y.one('#shell').append(container);
    return true;
};

var defaultArgs = ['id=35130544@N02','lang=en-us','format=json'];
var baseFlickrUrl = 'http://api.flickr.com/services/feeds/photos_public.gne?' + defaultArgs.join('&');
    
var objTransaction = Y.Get.script([
        baseFlickrUrl + "&tags=montreal"
        // baseFlickrUrl + "&tags=fireworks"
]);

});//end closure
</script>

    </body>
</html>
